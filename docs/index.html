<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Neuro-Symbolic AI for Drug Safety — Pralsetinib</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,300;0,400;0,600;1,300;1,400&family=DM+Sans:wght@300;400;500&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
  
  <!-- Vis Network -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/vis-network/9.1.2/dist/dist/vis-network.min.css" crossorigin="anonymous" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/vis-network/9.1.2/dist/vis-network.min.js" crossorigin="anonymous"></script>

  <style type="text/css">

             #mynetwork {
                 width: 100%;
                 height: 800px;
                 background-color: #0d1117;
                 border: 1px solid lightgray;
                 position: relative;
                 float: left;
             }

             
             #loadingBar {
                 position:absolute;
                 top:0px;
                 left:0px;
                 width: 100%;
                 height: 800px;
                 background-color:rgba(13,17,23,0.9);
                 -webkit-transition: all 0.5s ease;
                 -moz-transition: all 0.5s ease;
                 -ms-transition: all 0.5s ease;
                 -o-transition: all 0.5s ease;
                 transition: all 0.5s ease;
                 opacity:1;
             }

             #bar {
                 position:absolute;
                 top:0px;
                 left:0px;
                 width:20px;
                 height:20px;
                 margin:auto auto auto auto;
                 border-radius:11px;
                 border:2px solid rgba(30,30,30,0.05);
                 background: rgb(0, 173, 246); /* Old browsers */
                 box-shadow: 2px 0px 4px rgba(0,0,0,0.4);
             }

             #border {
                 position:absolute;
                 top:10px;
                 left:10px;
                 width:500px;
                 height:23px;
                 margin:auto auto auto auto;
                 box-shadow: 0px 0px 4px rgba(0,0,0,0.2);
                 border-radius:10px;
             }

             #text {
                 position:absolute;
                 top:8px;
                 left:530px;
                 width:30px;
                 height:50px;
                 margin:auto auto auto auto;
                 font-size:22px;
                 color: #c8a96e;
             }

             div.outerBorder {
                 position:relative;
                 top:400px;
                 width:600px;
                 height:44px;
                 margin:auto auto auto auto;
                 border:8px solid rgba(0,0,0,0.1);
                 background: rgb(252,252,252); /* Old browsers */
                 background: -moz-linear-gradient(top,  rgba(252,252,252,1) 0%, rgba(237,237,237,1) 100%); /* FF3.6+ */
                 background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,rgba(252,252,252,1)), color-stop(100%,rgba(237,237,237,1))); /* Chrome,Safari4+ */
                 background: -webkit-linear-gradient(top,  rgba(252,252,252,1) 0%,rgba(237,237,237,1) 100%); /* Chrome10+,Safari5.1+ */
                 background: -o-linear-gradient(top,  rgba(252,252,252,1) 0%,rgba(237,237,237,1) 100%); /* Opera 11.10+ */
                 background: -ms-linear-gradient(top,  rgba(252,252,252,1) 0%,rgba(237,237,237,1) 100%); /* IE10+ */
                 background: linear-gradient(to bottom,  rgba(252,252,252,1) 0%,rgba(237,237,237,1) 100%); /* W3C */
                 filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#fcfcfc', endColorstr='#ededed',GradientType=0 ); /* IE6-9 */
                 border-radius:72px;
                 box-shadow: 0px 0px 10px rgba(0,0,0,0.2);
             }
             

             

             
        </style>

  <style>
    /* ─── RESET & BASE ─── */
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

    :root {
      --ink:       #e8dfd0;
      --ink-dim:   #9a8f82;
      --ink-faint: #4a443d;
      --gold:      #c8a96e;
      --gold-dim:  #8a6e40;
      --bg:        #080b10;
      --bg-2:      #0d1117;
      --bg-3:      #111820;
      --border:    rgba(200,169,110,0.15);
      --red:       #e05c5c;
      --blue:      #5ba4e0;
      --orange:    #e09c3c;
      --green:     #5abf7a;
      --slate:     #8a9ab5;
    }

    html { scroll-behavior: smooth; }

    body {
      font-family: "DM Sans", sans-serif;
      background: var(--bg);
      color: var(--ink);
      line-height: 1.75;
      overflow-x: hidden;
    }

    /* ─── NAV ─── */
    nav {
      position: fixed; top: 0; left: 0; right: 0; z-index: 100;
      display: flex; align-items: center; justify-content: space-between;
      padding: 18px 48px;
      background: rgba(8,11,16,0.85);
      backdrop-filter: blur(12px);
      border-bottom: 1px solid var(--border);
    }
    nav .nav-brand {
      font-family: "Cormorant Garamond", serif;
      font-size: 15px; letter-spacing: 0.15em;
      color: var(--gold); text-decoration: none;
      text-transform: uppercase;
    }
    nav ul {
      list-style: none; display: flex; gap: 32px;
    }
    nav a {
      color: var(--ink-dim); text-decoration: none;
      font-size: 13px; letter-spacing: 0.08em;
      transition: color 0.2s;
    }
    nav a:hover { color: var(--gold); }

    /* ─── HERO ─── */
    .hero {
      min-height: 100vh;
      display: flex; align-items: center; justify-content: center;
      position: relative; overflow: hidden;
      text-align: center;
      padding: 140px 40px 100px;
    }

    .hero-bg {
      position: absolute; inset: 0;
      background: radial-gradient(ellipse 80% 60% at 50% 40%, rgba(200,169,110,0.06) 0%, transparent 70%),
                  radial-gradient(ellipse 40% 40% at 20% 80%, rgba(91,164,224,0.05) 0%, transparent 60%),
                  radial-gradient(ellipse 30% 30% at 80% 20%, rgba(90,191,122,0.04) 0%, transparent 50%);
    }

    .hero-grid {
      position: absolute; inset: 0;
      background-image:
        linear-gradient(rgba(200,169,110,0.04) 1px, transparent 1px),
        linear-gradient(90deg, rgba(200,169,110,0.04) 1px, transparent 1px);
      background-size: 60px 60px;
      mask-image: radial-gradient(ellipse 70% 70% at 50% 50%, black 30%, transparent 80%);
    }

    .hero-content { position: relative; z-index: 1; max-width: 860px; }

    .hero-eyebrow {
      font-size: 12px; letter-spacing: 0.25em;
      color: var(--gold); text-transform: uppercase;
      margin-bottom: 28px;
      display: flex; align-items: center; justify-content: center; gap: 12px;
    }
    .hero-eyebrow::before, .hero-eyebrow::after {
      content: ""; display: block; width: 40px; height: 1px;
      background: var(--gold-dim);
    }

    .hero h1 {
      font-family: "Cormorant Garamond", serif;
      font-size: clamp(42px, 6vw, 80px);
      font-weight: 300; line-height: 1.15;
      color: var(--ink);
      margin-bottom: 24px;
    }
    .hero h1 em {
      font-style: italic; color: var(--gold);
    }

    .hero-sub {
      font-size: 16px; color: var(--ink-dim);
      max-width: 560px; margin: 0 auto 16px;
      font-weight: 300;
    }

    .hero-case {
      display: inline-block;
      margin-top: 20px;
      padding: 8px 20px;
      border: 1px solid var(--border);
      border-radius: 2px;
      font-family: "JetBrains Mono", monospace;
      font-size: 12px;
      color: var(--gold-dim);
      letter-spacing: 0.12em;
    }

    .hero-scroll {
      position: absolute; bottom: 40px; left: 50%; transform: translateX(-50%);
      display: flex; flex-direction: column; align-items: center; gap: 8px;
      color: var(--ink-faint); font-size: 11px; letter-spacing: 0.2em;
      text-transform: uppercase;
    }
    .scroll-line {
      width: 1px; height: 40px;
      background: linear-gradient(to bottom, var(--gold-dim), transparent);
      animation: scrollPulse 2s ease-in-out infinite;
    }
    @keyframes scrollPulse {
      0%, 100% { opacity: 0.3; transform: scaleY(1); }
      50% { opacity: 1; transform: scaleY(1.2); }
    }

    /* ─── SECTIONS ─── */
    .section {
      max-width: 1100px; margin: 0 auto;
      padding: 100px 48px;
    }

    .section-full {
      padding: 100px 48px;
    }

    .section-alt {
      background: var(--bg-2);
      border-top: 1px solid var(--border);
      border-bottom: 1px solid var(--border);
    }

    .section-inner {
      max-width: 1100px; margin: 0 auto;
    }

    .section-label {
      font-size: 11px; letter-spacing: 0.3em;
      color: var(--gold); text-transform: uppercase;
      margin-bottom: 16px;
      display: flex; align-items: center; gap: 12px;
    }
    .section-label::after {
      content: ""; flex: 0 0 32px; height: 1px; background: var(--gold-dim);
    }

    h2 {
      font-family: "Cormorant Garamond", serif;
      font-size: clamp(28px, 4vw, 46px);
      font-weight: 300; line-height: 1.2;
      color: var(--ink);
      margin-bottom: 28px;
    }

    h3 {
      font-family: "Cormorant Garamond", serif;
      font-size: 22px; font-weight: 400;
      color: var(--ink); margin-bottom: 10px;
    }

    p { color: var(--ink-dim); font-size: 16px; margin-bottom: 16px; font-weight: 300; }

    /* ─── CHALLENGE TWO COL ─── */
    .two-col {
      display: grid; grid-template-columns: 1fr 1fr;
      gap: 60px; align-items: start;
      margin-top: 48px;
    }
    @media (max-width: 700px) { .two-col { grid-template-columns: 1fr; gap: 40px; } }

    .challenge-item {
      padding: 32px;
      border: 1px solid var(--border);
      border-radius: 4px;
      position: relative;
      background: rgba(200,169,110,0.02);
      transition: border-color 0.3s, background 0.3s;
    }
    .challenge-item:hover {
      border-color: rgba(200,169,110,0.3);
      background: rgba(200,169,110,0.04);
    }
    .challenge-item .number {
      font-family: "Cormorant Garamond", serif;
      font-size: 64px; font-weight: 300;
      color: var(--ink-faint); line-height: 1;
      position: absolute; top: 20px; right: 24px;
      pointer-events: none;
    }

    /* ─── RESEARCH QUESTION ─── */
    .rq-box {
      margin-top: 48px;
      padding: 48px 56px;
      border-left: 3px solid var(--gold);
      background: rgba(200,169,110,0.04);
    }
    .rq-box p {
      font-family: "Cormorant Garamond", serif;
      font-size: clamp(20px, 2.5vw, 28px);
      font-weight: 300; font-style: italic;
      color: var(--ink);
      line-height: 1.6; margin: 0;
    }

    /* ─── FLOW DIAGRAM ─── */
    .flow-diagram {
      display: flex; align-items: center; justify-content: center;
      gap: 0; margin: 60px 0 40px; flex-wrap: wrap;
    }
    .flow-node {
      display: flex; flex-direction: column;
      align-items: center; text-align: center;
    }
    .flow-bubble {
      width: 130px; height: 130px; border-radius: 50%;
      display: flex; align-items: center; justify-content: center;
      border: 2px solid;
      font-size: 13px; font-weight: 500;
      letter-spacing: 0.05em;
      position: relative;
      transition: transform 0.3s;
    }
    .flow-bubble:hover { transform: scale(1.05); }
    .flow-node .flow-label {
      font-size: 11px; color: var(--ink-dim);
      margin-top: 10px; letter-spacing: 0.1em;
    }

    .flow-arrow {
      width: 48px; height: 2px;
      position: relative; margin-bottom: 48px;
      flex-shrink: 0;
    }
    .flow-arrow::before {
      content: ""; position: absolute; inset: 0;
      background: linear-gradient(to right, var(--ink-faint), var(--gold-dim));
    }
    .flow-arrow::after {
      content: ""; position: absolute; right: -1px; top: -4px;
      border-left: 8px solid var(--gold-dim);
      border-top: 5px solid transparent;
      border-bottom: 5px solid transparent;
    }

    .fb-drug   { border-color: var(--red);    color: var(--red);    background: rgba(224,92,92,0.06); }
    .fb-prot   { border-color: var(--blue);   color: var(--blue);   background: rgba(91,164,224,0.06); }
    .fb-go     { border-color: var(--slate);  color: var(--slate);  background: rgba(138,154,181,0.06); }
    .fb-tox    { border-color: var(--orange); color: var(--orange); background: rgba(224,156,60,0.06); }

    /* ─── DATA SOURCES ─── */
    .data-grid {
      display: grid; grid-template-columns: repeat(3, 1fr);
      gap: 2px; margin-top: 48px;
    }
    @media (max-width: 700px) { .data-grid { grid-template-columns: 1fr; } }

    .data-card {
      padding: 40px 36px;
      border: 1px solid var(--border);
      background: var(--bg);
      position: relative; overflow: hidden;
      transition: background 0.3s;
    }
    .data-card:hover { background: rgba(200,169,110,0.03); }
    .data-card .dc-accent {
      position: absolute; top: 0; left: 0; right: 0;
      height: 2px;
    }
    .data-card .dc-num {
      font-family: "Cormorant Garamond", serif;
      font-size: 11px; color: var(--ink-faint);
      letter-spacing: 0.2em; margin-bottom: 20px;
    }
    .data-card h3 {
      font-size: 20px; margin-bottom: 8px;
    }
    .data-card p { font-size: 14px; margin: 0; }

    /* ─── GRAPH SECTION ─── */
    .graph-wrapper {
      margin-top: 40px;
      border: 1px solid var(--border);
      border-radius: 6px;
      overflow: hidden;
      position: relative;
      background: var(--bg-2);
    }

    .graph-header {
      padding: 16px 24px;
      border-bottom: 1px solid var(--border);
      display: flex; align-items: center; justify-content: space-between;
      background: var(--bg-3);
    }
    .graph-header .dot-row {
      display: flex; gap: 6px;
    }
    .graph-header .dot {
      width: 10px; height: 10px; border-radius: 50%;
    }
    .graph-header .dot-r { background: #ff5f57; }
    .graph-header .dot-y { background: #ffbd2e; }
    .graph-header .dot-g { background: #28ca41; }
    .graph-header .graph-title {
      font-family: "JetBrains Mono", monospace;
      font-size: 12px; color: var(--ink-dim);
    }

    .graph-legend {
      padding: 12px 24px;
      border-top: 1px solid var(--border);
      display: flex; align-items: center; gap: 24px; flex-wrap: wrap;
      background: var(--bg-3);
    }
    .legend-item {
      display: flex; align-items: center; gap: 7px;
      font-size: 12px; color: var(--ink-dim);
    }
    .legend-dot {
      width: 10px; height: 10px; border-radius: 50%; flex-shrink: 0;
    }

    /* Override vis.js container bg */
    #mynetwork {
      background-color: var(--bg-2) !important;
      height: 680px !important;
    }

    /* ─── MODELING ─── */
    .model-compare {
      display: grid; grid-template-columns: 1fr 1fr;
      gap: 24px; margin-top: 48px;
    }
    @media (max-width: 700px) { .model-compare { grid-template-columns: 1fr; } }

    .model-card {
      padding: 36px;
      border: 1px solid var(--border);
      border-radius: 4px;
      position: relative;
    }
    .model-card.baseline {
      border-color: rgba(138,154,181,0.3);
    }
    .model-card.enhanced {
      border-color: rgba(200,169,110,0.4);
      background: rgba(200,169,110,0.03);
    }
    .model-badge {
      font-size: 10px; letter-spacing: 0.2em; text-transform: uppercase;
      padding: 3px 10px; border-radius: 2px; display: inline-block;
      margin-bottom: 16px;
    }
    .badge-baseline { background: rgba(138,154,181,0.1); color: var(--slate); }
    .badge-enhanced { background: rgba(200,169,110,0.1); color: var(--gold); }

    .path-display {
      font-family: "JetBrains Mono", monospace;
      font-size: 13px; color: var(--gold);
      background: rgba(200,169,110,0.06);
      padding: 16px 20px; border-radius: 3px;
      margin: 20px 0; text-align: center;
    }

    /* ─── FINDINGS ─── */
    .findings-list {
      list-style: none; margin-top: 48px;
      display: flex; flex-direction: column; gap: 2px;
    }
    .findings-list li {
      padding: 28px 36px;
      border: 1px solid var(--border);
      display: flex; align-items: flex-start; gap: 24px;
      background: var(--bg); transition: background 0.3s;
    }
    .findings-list li:hover { background: rgba(200,169,110,0.03); }
    .fi-num {
      font-family: "Cormorant Garamond", serif;
      font-size: 32px; font-weight: 300;
      color: var(--gold-dim); line-height: 1; flex-shrink: 0;
      width: 36px;
    }
    .fi-text {
      font-size: 16px; color: var(--ink-dim);
      font-weight: 300; padding-top: 4px;
    }

    /* ─── IMPACT / TAGS ─── */
    .tags {
      display: flex; flex-wrap: wrap; gap: 10px;
      margin-top: 32px;
    }
    .tag {
      padding: 6px 16px; border-radius: 2px;
      font-size: 12px; letter-spacing: 0.08em;
      border: 1px solid var(--border);
      color: var(--ink-dim);
    }
    .tag.highlight { border-color: var(--gold-dim); color: var(--gold); }

    /* ─── DETAILS (tech arch) ─── */
    details {
      margin-top: 24px;
      border: 1px solid var(--border);
      border-radius: 3px;
      overflow: hidden;
    }
    summary {
      padding: 16px 20px;
      cursor: pointer;
      font-size: 14px; color: var(--ink-dim);
      display: flex; align-items: center; gap: 10px;
      transition: color 0.2s; list-style: none;
    }
    summary::before {
      content: "+"; font-size: 18px; color: var(--gold-dim);
      transition: transform 0.2s;
    }
    details[open] summary::before { content: "−"; }
    summary:hover { color: var(--ink); }
    details > div {
      padding: 20px; border-top: 1px solid var(--border);
    }
    details > div p { font-size: 14px; margin: 0; }

    /* ─── FOOTER ─── */
    footer {
      background: var(--bg-3);
      border-top: 1px solid var(--border);
      padding: 60px 48px;
      text-align: center;
    }
    footer p { color: var(--ink-faint); font-size: 13px; margin: 0; }
    footer .footer-title {
      font-family: "Cormorant Garamond", serif;
      font-size: 18px; color: var(--ink-dim);
      margin-bottom: 10px;
    }
    footer .footer-line {
      width: 40px; height: 1px; background: var(--gold-dim);
      margin: 20px auto;
    }

    /* ─── FADE-IN ANIMATION ─── */
    .fade-in {
      opacity: 0; transform: translateY(24px);
      transition: opacity 0.7s ease, transform 0.7s ease;
    }
    .fade-in.visible {
      opacity: 1; transform: translateY(0);
    }
  </style>
</head>
<body>

<!-- NAV -->
<nav>
  <a class="nav-brand" href="#">Neuro-Symbolic AI</a>
  <ul>
    <li><a href="#challenge">Challenge</a></li>
    <li><a href="#approach">Approach</a></li>
    <li><a href="#graph">Graph</a></li>
    <li><a href="#findings">Findings</a></li>
  </ul>
</nav>

<!-- HERO -->
<section class="hero">
  <div class="hero-bg"></div>
  <div class="hero-grid"></div>
  <div class="hero-content fade-in">
    <div class="hero-eyebrow">DSC 180B Capstone · UC San Diego</div>
    <h1>Neuro-Symbolic AI<br>for <em>Drug Safety</em></h1>
    <p class="hero-sub">
      Mechanistically grounding off-target toxicity signals in biology
      through knowledge graph reasoning.
    </p>
    <div class="hero-case">CASE STUDY: PRALSETINIB</div>
  </div>
  <div class="hero-scroll">
    <div class="scroll-line"></div>
    <span>Explore</span>
  </div>
</section>

<!-- CHALLENGE -->
<section id="challenge" class="section">
  <div class="section-label">01 — Challenge</div>
  <h2>The limits of statistical<br>pharmacovigilance</h2>
  <div class="two-col fade-in">
    <div class="challenge-item">
      <span class="number">01</span>
      <h3>Signal without explanation</h3>
      <p>Modern pharmacovigilance systems detect statistical safety signals — but rarely explain <em>why</em> adverse events occur.</p>
    </div>
    <div class="challenge-item">
      <span class="number">02</span>
      <h3>Interpretability imperative</h3>
      <p>When a patient develops infection or hepatic injury, what biological mechanisms connect those outcomes to molecular drug interactions? In healthcare, predictive accuracy is not enough.</p>
    </div>
  </div>
</section>

<!-- RESEARCH QUESTION -->
<div class="section-alt section-full">
  <div class="section-inner section">
    <div class="section-label">02 — Research Question</div>
    <h2>Can we ground AI models<br>in mechanistic biology?</h2>
    <div class="rq-box fade-in">
      <p>Can ontologies ground AI models for drug toxicity analysis by enabling mechanistically interpretable reasoning from molecular interactions to real-world adverse events?</p>
    </div>
  </div>
</div>

<!-- APPROACH -->
<section id="approach" class="section">
  <div class="section-label">03 — Approach</div>
  <h2>A multi-layer knowledge<br>graph architecture</h2>
  <p>We integrated curated biological databases with real-world post-marketing safety data into a unified reasoning framework.</p>

  <div class="flow-diagram fade-in">
    <div class="flow-node">
      <div class="flow-bubble fb-drug">Drug</div>
      <span class="flow-label">Pralsetinib</span>
    </div>
    <div class="flow-arrow"></div>
    <div class="flow-node">
      <div class="flow-bubble fb-prot">Protein<br>Target</div>
      <span class="flow-label">DrugBank</span>
    </div>
    <div class="flow-arrow"></div>
    <div class="flow-node">
      <div class="flow-bubble fb-go">GO<br>Process</div>
      <span class="flow-label">Gene Ontology</span>
    </div>
    <div class="flow-arrow"></div>
    <div class="flow-node">
      <div class="flow-bubble fb-tox">Toxicity<br>Theme</div>
      <span class="flow-label">FAERS</span>
    </div>
  </div>

  <p>This structure enables path-based reasoning across molecular, biological, and clinical layers of abstraction.</p>
</section>

<!-- DATA SOURCES -->
<div class="section-alt section-full">
  <div class="section-inner section">
    <div class="section-label">04 — Data Integration</div>
    <h2>Three curated sources,<br>one reasoning framework</h2>
    <div class="data-grid fade-in">
      <div class="data-card">
        <div class="dc-accent" style="background: linear-gradient(to right, var(--red), transparent);"></div>
        <div class="dc-num">01</div>
        <h3>DrugBank</h3>
        <p>Defines high-confidence drug–protein interactions, providing the molecular entry point for mechanistic reasoning.</p>
      </div>
      <div class="data-card">
        <div class="dc-accent" style="background: linear-gradient(to right, var(--blue), transparent);"></div>
        <div class="dc-num">02</div>
        <h3>Gene Ontology</h3>
        <p>Maps proteins to biological processes, enabling the mechanistic middle layer between molecular targets and clinical outcomes.</p>
      </div>
      <div class="data-card">
        <div class="dc-accent" style="background: linear-gradient(to right, var(--orange), transparent);"></div>
        <div class="dc-num">03</div>
        <h3>FAERS</h3>
        <p>Provides real-world adverse event signals from post-marketing surveillance, used as weak supervision for toxicity themes.</p>
      </div>
    </div>
  </div>
</div>
<!-- INTERACTIVE GRAPH -->
<section id="graph" class="section">
  <div class="section-label">05 — Knowledge Graph</div>
  <h2>Explore the molecular<br>reasoning network</h2>
  <p>Pralsetinib's connections to proteins, biological processes, and observed toxicity themes — interactive and explorable.</p>

  <div class="graph-wrapper fade-in">
    <div class="graph-header">
      <div class="dot-row">
        <div class="dot dot-r"></div>
        <div class="dot dot-y"></div>
        <div class="dot dot-g"></div>
      </div>
      <span class="graph-title">pralsetinib_knowledge_graph.vis</span>
      <span></span>
    </div>

    <!-- Filter controls -->
    <div class="kg-controls">
      <span class="kg-controls-label">show:</span>
      <button class="kg-toggle active" data-type="Drug">
        <span class="kg-toggle-dot" style="background:#ff6b6b"></span>Drug
      </button>
      <button class="kg-toggle active" data-type="Target">
        <span class="kg-toggle-dot" style="background:#4dabf7"></span>Protein
      </button>
      <button class="kg-toggle active" data-type="AdverseEvent">
        <span class="kg-toggle-dot" style="background:#ffa94d"></span>Adverse Events
      </button>
      <button class="kg-toggle active" data-type="Disease">
        <span class="kg-toggle-dot" style="background:#51cf66"></span>Disease
      </button>
      <button class="kg-toggle active" data-type="BiologicalProcess">
        <span class="kg-toggle-dot" style="background:#ced4da"></span>GO Process
      </button>
      <button class="kg-reset" id="kgResetBtn">&#8635; reset</button>
    </div>

    <div class="card" style="width:100%">
      <div id="mynetwork" class="card-body"></div>
    </div>

    <div id="loadingBar">
      <div class="outerBorder">
        <div id="text">0%</div>
        <div id="border">
          <div id="bar"></div>
        </div>
      </div>
    </div>

    <div class="kg-hint">click a node to explore its connections &nbsp;·&nbsp; click background to reset</div>

    <script type="text/javascript">
    (function () {
      var nodesDS, edgesDS, network;
      var activeTypes = new Set(['Drug','Target','AdverseEvent','Disease','BiologicalProcess']);
      var highlightActive = false;
      var SHOW_LABEL_TYPES = new Set(['Drug','Target']);

      function nodeFont(showLabel) {
        return showLabel
          ? { color: '#c8d0e0', size: 11, face: "'SF Mono','Fira Code',monospace", strokeWidth: 2, strokeColor: '#0d0d0d' }
          : { color: 'transparent', size: 0 };
      }

      async function drawGraph() {
        var container = document.getElementById('mynetwork');
        var nodesJson = [], edgesJson = [];

        try {
          var res = await Promise.all([
            fetch('assets/data/nodes.json'),
            fetch('assets/data/edges.json')
          ]);
          if (!res[0].ok || !res[1].ok) throw new Error('fetch failed');
          nodesJson = await res[0].json();
          edgesJson = await res[1].json();
        } catch (e) {
          console.warn('Graph JSON load failed:', e);
        }

        /* process nodes: stash original label, hide for non-key types */
        var processed = nodesJson.map(function (n) {
          var show = SHOW_LABEL_TYPES.has(n.node_type);
          return Object.assign({}, n, {
            _lbl: n.label,
            label: show ? n.label : '',
            font: nodeFont(show),
            borderWidth: 0,
            shadow: { enabled: true, color: 'rgba(0,0,0,0.55)', size: 10, x: 0, y: 0 }
          });
        });

        /* stable edge IDs */
        var edgesProcessed = edgesJson.map(function (e, i) {
          return Object.assign({}, e, {
            id: e.id !== undefined ? e.id : 'e' + i,
            font: { size: 0, color: 'transparent' },
            smooth: { type: 'continuous' }
          });
        });

        nodesDS = new vis.DataSet(processed);
        edgesDS  = new vis.DataSet(edgesProcessed);

        var options = {
          physics: {
            enabled: true,
            stabilization: { iterations: 250, updateInterval: 10 },
            barnesHut: {
              gravitationalConstant: -14000,
              centralGravity: 0.25,
              springLength: 160,
              springConstant: 0.03,
              damping: 0.12,
              avoidOverlap: 0.6
            }
          },
          edges: {
            color: {
              color: 'rgba(90,110,150,0.3)',
              highlight: 'rgba(120,190,255,0.9)',
              hover: 'rgba(120,190,255,0.5)'
            },
            width: 1,
            selectionWidth: 2,
            arrows: { to: { enabled: true, scaleFactor: 0.35 } },
            smooth: { type: 'continuous' }
          },
          nodes: { borderWidth: 0 },
          interaction: {
            hover: true,
            tooltipDelay: 150,
            hideEdgesOnDrag: true,
            multiselect: false
          }
        };

        network = new vis.Network(container, { nodes: nodesDS, edges: edgesDS }, options);

        /* loading bar progress */
        network.on('stabilizationProgress', function (p) {
          document.getElementById('loadingBar').removeAttribute('style');
          var pct = p.iterations / p.total;
          document.getElementById('bar').style.width = Math.max(20, 496 * pct) + 'px';
          document.getElementById('text').innerHTML = Math.round(pct * 100) + '%';
        });

        /* freeze layout after stabilisation */
        network.once('stabilizationIterationsDone', function () {
          document.getElementById('text').innerHTML = '100%';
          document.getElementById('bar').style.width = '496px';
          document.getElementById('loadingBar').style.opacity = 0;
          setTimeout(function () {
            document.getElementById('loadingBar').style.display = 'none';
            network.setOptions({ physics: { enabled: false } });
          }, 500);
        });

        /* click to highlight neighbourhood */
        network.on('click', function (params) {
          if (params.nodes.length > 0) {
            highlightNode(params.nodes[0]);
          } else {
            resetHighlight();
          }
        });
      }

      /* ── highlight ── */
      function highlightNode(nodeId) {
        highlightActive = true;
        var connNodes = new Set(network.getConnectedNodes(nodeId));
        var connEdges = new Set(network.getConnectedEdges(nodeId));
        connNodes.add(nodeId);

        nodesDS.update(nodesDS.get().map(function (n) {
          var hit = connNodes.has(n.id);
          return {
            id: n.id,
            opacity: hit ? 1 : 0.07,
            label: hit ? n._lbl : '',
            font: nodeFont(hit)
          };
        }));

        edgesDS.update(edgesDS.get().map(function (e) {
          var hit = connEdges.has(e.id);
          return {
            id: e.id,
            color: { color: hit ? 'rgba(120,190,255,0.75)' : 'rgba(90,110,150,0.04)' },
            width: hit ? 1.5 : 1
          };
        }));
      }

      function resetHighlight() {
        if (!highlightActive) return;
        highlightActive = false;

        nodesDS.update(nodesDS.get().map(function (n) {
          var show = SHOW_LABEL_TYPES.has(n.node_type);
          return {
            id: n.id,
            opacity: 1,
            label: show ? n._lbl : '',
            font: nodeFont(show)
          };
        }));

        edgesDS.update(edgesDS.get().map(function (e) {
          return { id: e.id, color: { color: 'rgba(90,110,150,0.3)' }, width: 1 };
        }));
      }

      /* ── type toggles ── */
      document.querySelectorAll('.kg-toggle').forEach(function (btn) {
        btn.addEventListener('click', function () {
          var type = this.dataset.type;
          if (activeTypes.has(type)) {
            activeTypes.delete(type);
            this.classList.remove('active');
          } else {
            activeTypes.add(type);
            this.classList.add('active');
          }
          if (highlightActive) resetHighlight();
          nodesDS.update(nodesDS.get().map(function (n) {
            return { id: n.id, hidden: !activeTypes.has(n.node_type) };
          }));
        });
      });

      document.getElementById('kgResetBtn').addEventListener('click', function () {
        resetHighlight();
        activeTypes = new Set(['Drug','Target','AdverseEvent','Disease','BiologicalProcess']);
        document.querySelectorAll('.kg-toggle').forEach(function (b) { b.classList.add('active'); });
        nodesDS.update(nodesDS.get().map(function (n) { return { id: n.id, hidden: false }; }));
      });

      drawGraph();
    })();
    </script>

    <div class="graph-legend">
      <span class="legend-item"><span class="legend-dot" style="background:var(--red)"></span>Drug</span>
      <span class="legend-item"><span class="legend-dot" style="background:var(--blue)"></span>Protein</span>
      <span class="legend-item"><span class="legend-dot" style="background:var(--orange)"></span>Adverse Event</span>
      <span class="legend-item"><span class="legend-dot" style="background:var(--green)"></span>Disease</span>
      <span class="legend-item"><span class="legend-dot" style="background:var(--slate)"></span>GO Process</span>
    </div>
  </div>
</section>

<style>
.kg-controls {
  display: flex;
  align-items: center;
  gap: 6px;
  padding: 10px 14px;
  background: rgba(255,255,255,0.02);
  border-bottom: 1px solid rgba(255,255,255,0.06);
  flex-wrap: wrap;
}
.kg-controls-label {
  font-family: 'SF Mono','Fira Code',monospace;
  font-size: 10px;
  color: rgba(255,255,255,0.28);
  text-transform: uppercase;
  letter-spacing: 0.08em;
  margin-right: 2px;
}
.kg-toggle {
  display: flex;
  align-items: center;
  gap: 5px;
  padding: 4px 10px;
  background: rgba(255,255,255,0.04);
  border: 1px solid rgba(255,255,255,0.08);
  border-radius: 3px;
  color: rgba(255,255,255,0.3);
  font-family: 'SF Mono','Fira Code',monospace;
  font-size: 10px;
  cursor: pointer;
  transition: all 0.15s ease;
  letter-spacing: 0.03em;
  user-select: none;
}
.kg-toggle:hover {
  border-color: rgba(255,255,255,0.2);
  color: rgba(255,255,255,0.6);
  background: rgba(255,255,255,0.06);
}
.kg-toggle.active {
  background: rgba(255,255,255,0.06);
  border-color: rgba(255,255,255,0.18);
  color: rgba(255,255,255,0.82);
}
.kg-toggle-dot {
  width: 7px;
  height: 7px;
  border-radius: 50%;
  flex-shrink: 0;
  opacity: 0.3;
  transition: opacity 0.15s ease;
}
.kg-toggle.active .kg-toggle-dot { opacity: 1; }
.kg-reset {
  margin-left: auto;
  padding: 4px 10px;
  background: transparent;
  border: 1px solid rgba(255,255,255,0.08);
  border-radius: 3px;
  color: rgba(255,255,255,0.22);
  font-family: 'SF Mono','Fira Code',monospace;
  font-size: 10px;
  cursor: pointer;
  transition: all 0.15s ease;
  letter-spacing: 0.03em;
}
.kg-reset:hover {
  color: rgba(255,255,255,0.6);
  border-color: rgba(255,255,255,0.22);
}
.kg-hint {
  padding: 7px 14px;
  font-family: 'SF Mono','Fira Code',monospace;
  font-size: 9px;
  color: rgba(255,255,255,0.15);
  letter-spacing: 0.06em;
  text-align: right;
  border-top: 1px solid rgba(255,255,255,0.04);
}
</style>


<!-- MODELING -->
<div class="section-alt section-full">
  <div class="section-inner section">
    <div class="section-label">06 — Modeling Strategy</div>
    <h2>From frequency ranking<br>to mechanistic paths</h2>

    <div class="model-compare fade-in">
      <div class="model-card baseline">
        <span class="model-badge badge-baseline">Baseline</span>
        <h3>FAERS-Only Ranking</h3>
        <p>Toxicity themes ranked purely by adverse event frequency. No biological reasoning incorporated — a statistical signal without mechanistic grounding.</p>
      </div>
      <div class="model-card enhanced">
        <span class="model-badge badge-enhanced">Ontology-Grounded</span>
        <h3>Path Scoring</h3>
        <p>Mechanistic paths weighted by biological role and FAERS support, enabling interpretable hypothesis generation.</p>
        <div class="path-display">Drug → Protein → GO Process → Toxicity</div>
      </div>
    </div>

    <details>
      <summary>Technical Architecture</summary>
      <div>
        <p>Nodes include Drug, Protein, GO Biological Process, and Toxicity Theme. Edges encode molecular binding, pathway involvement, and real-world safety associations. Modeling includes path-based scoring and optional feature extraction for interpretable ML models.</p>
      </div>
    </details>
  </div>
</div>

<!-- FINDINGS -->
<section id="findings" class="section">
  <div class="section-label">07 — Observations</div>
  <h2>What the graph reveals</h2>

  <ul class="findings-list fade-in">
    <li>
      <span class="fi-num">I</span>
      <span class="fi-text">Ontology-grounded scoring produces biologically coherent hypotheses, connecting molecular targets to plausible toxicity themes through known pathways.</span>
    </li>
    <li>
      <span class="fi-num">II</span>
      <span class="fi-text">Mechanistic chains link immune signaling pathways to infection reports — providing an explanatory basis for observed FAERS adverse events.</span>
    </li>
    <li>
      <span class="fi-num">III</span>
      <span class="fi-text">Structured reasoning improves interpretability over frequency-based ranking, generating hypotheses that can be evaluated by domain experts.</span>
    </li>
  </ul>
</section>

<!-- IMPACT & LIMITATIONS -->
<div class="section-alt section-full">
  <div class="section-inner section">
    <div class="section-label">08 — Impact & Limitations</div>
    <div class="two-col">
      <div class="fade-in">
        <h2>Why this matters</h2>
        <p>Most AI systems in healthcare produce probabilities. This framework produces <strong style="color:var(--ink)">mechanistic explanations</strong> — bridging molecular biology and patient-level outcomes.</p>
        <p>Ontology-grounded reasoning improves transparency in drug safety analysis, enabling clinicians and researchers to interrogate the basis of any prediction.</p>
        <div class="tags">
          <span class="tag highlight">Interpretability</span>
          <span class="tag highlight">Mechanistic AI</span>
          <span class="tag">Pharmacovigilance</span>
          <span class="tag">Knowledge Graphs</span>
          <span class="tag">Drug Safety</span>
        </div>
      </div>
      <div class="fade-in">
        <h2>Limitations</h2>
        <p>Current scope and known constraints of this work:</p>
        <div class="tags" style="flex-direction: column; gap: 8px;">
          <span class="tag" style="display:block">Single-drug case study — generalization requires validation across additional compounds</span>
          <span class="tag" style="display:block">Manual components in GO-to-toxicity alignment may introduce inconsistencies</span>
          <span class="tag" style="display:block">Reporting bias in FAERS data can skew adverse event frequency signals</span>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- FOOTER -->
<footer>
  <div class="footer-title">Neuro-Symbolic AI for Off-Target Toxicity</div>
  <div class="footer-line"></div>
  <p>DSC 180B Capstone Project &nbsp;·&nbsp; University of California, San Diego</p>
</footer>

<script>
  // Fade-in on scroll
  const observer = new IntersectionObserver((entries) => {
    entries.forEach(e => { if (e.isIntersecting) { e.target.classList.add("visible"); } });
  }, { threshold: 0.1 });
  document.querySelectorAll(".fade-in").forEach(el => observer.observe(el));
</script>

</body>
</html>